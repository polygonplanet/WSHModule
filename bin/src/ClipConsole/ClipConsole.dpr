{
  ClipConsole

  2014-01-03
  polygon planet <polygon.planet.aqua@gmail.com>
}

program ClipConsole;

{.$DEFINE CLIPCONSOLE_DEBUG}
{$UNDEF CLIPCONSOLE_DEBUG}


{ -- Check memory -- }
{.$DEFINE CLIPCONSOLE_DEBUG_MEMORY}


{$IFNDEF CLIPCONSOLE_DEBUG}
  {$UNDEF CLIPCONSOLE_DEBUG_MEMORY}
{$ENDIF}


{ -- Compiler options -- }
{$IFDEF CLIPCONSOLE_DEBUG}
  {$A8,B-,C+,D+,E-,F-,G+,H+,I+,J-,K-,L+,M-,N+,O+}
  {$P+,Q-,R-,S-,T-,U-,V+,W+,X+,Y+,Z1}
  {$MINSTACKSIZE $00004000}
  {$MAXSTACKSIZE $00100000}
  {$IMAGEBASE $00400000}
  {$WARN SYMBOL_DEPRECATED ON}
  {$WARN SYMBOL_LIBRARY ON}
  {$WARN SYMBOL_PLATFORM ON}
  {$WARN UNIT_LIBRARY ON}
  {$WARN UNIT_PLATFORM ON}
  {$WARN UNIT_DEPRECATED ON}
  {$WARN HRESULT_COMPAT ON}
  {$WARN HIDING_MEMBER ON}
  {$WARN HIDDEN_VIRTUAL ON}
  {$WARN GARBAGE ON}
  {$WARN BOUNDS_ERROR ON}
  {$WARN ZERO_NIL_COMPAT ON}
  {$WARN STRING_CONST_TRUNCED ON}
  {$WARN FOR_LOOP_VAR_VARPAR ON}
  {$WARN TYPED_CONST_VARPAR ON}
  {$WARN ASG_TO_TYPED_CONST ON}
  {$WARN CASE_LABEL_RANGE ON}
  {$WARN FOR_VARIABLE ON}
  {$WARN CONSTRUCTING_ABSTRACT ON}
  {$WARN COMPARISON_FALSE ON}
  {$WARN COMPARISON_TRUE ON}
  {$WARN COMPARING_SIGNED_UNSIGNED ON}
  {$WARN COMBINING_SIGNED_UNSIGNED ON}
  {$WARN UNSUPPORTED_CONSTRUCT ON}
  {$WARN FILE_OPEN ON}
  {$WARN FILE_OPEN_UNITSRC ON}
  {$WARN BAD_GLOBAL_SYMBOL ON}
  {$WARN DUPLICATE_CTOR_DTOR ON}
  {$WARN INVALID_DIRECTIVE ON}
  {$WARN PACKAGE_NO_LINK ON}
  {$WARN PACKAGED_THREADVAR ON}
  {$WARN IMPLICIT_IMPORT ON}
  {$WARN HPPEMIT_IGNORED ON}
  {$WARN NO_RETVAL ON}
  {$WARN USE_BEFORE_DEF ON}
  {$WARN FOR_LOOP_VAR_UNDEF ON}
  {$WARN UNIT_NAME_MISMATCH ON}
  {$WARN NO_CFG_FILE_FOUND ON}
  {$WARN MESSAGE_DIRECTIVE ON}
  {$WARN IMPLICIT_VARIANTS ON}
  {$WARN UNICODE_TO_LOCALE ON}
  {$WARN LOCALE_TO_UNICODE ON}
  {$WARN IMAGEBASE_MULTIPLE ON}
  {$WARN SUSPICIOUS_TYPECAST ON}
  {$WARN PRIVATE_PROPACCESSOR ON}
  {$WARN UNSAFE_TYPE OFF}
  {$WARN UNSAFE_CODE OFF}
  {$WARN UNSAFE_CAST OFF}


  {$IFDEF CLIPCONSOLE_DEBUG_MEMORY}
    {$DEFINE FullDebugMode}
    {$DEFINE LogMemoryLeakDetailToFile}
    {$DEFINE ClearLogFileOnStartup}
    {$DEFINE EnableMemory}
  {$ENDIF}

{$ELSE}
  {$A8,B-,C-,D-,E-,F-,G+,H+,I+,J-,K-,L-,M-,N+,O+}
  {$P+,Q-,R-,S-,T-,U-,V+,W-,X+,Y-,Z1}
  {$MINSTACKSIZE $00004000}
  {$MAXSTACKSIZE $00100000}
  {$IMAGEBASE $00400000}
  {$WARN SYMBOL_DEPRECATED ON}
  {$WARN SYMBOL_LIBRARY ON}
  {$WARN SYMBOL_PLATFORM ON}
  {$WARN UNIT_LIBRARY ON}
  {$WARN UNIT_PLATFORM ON}
  {$WARN UNIT_DEPRECATED ON}
  {$WARN HRESULT_COMPAT ON}
  {$WARN HIDING_MEMBER ON}
  {$WARN HIDDEN_VIRTUAL ON}
  {$WARN GARBAGE ON}
  {$WARN BOUNDS_ERROR ON}
  {$WARN ZERO_NIL_COMPAT ON}
  {$WARN STRING_CONST_TRUNCED ON}
  {$WARN FOR_LOOP_VAR_VARPAR ON}
  {$WARN TYPED_CONST_VARPAR ON}
  {$WARN ASG_TO_TYPED_CONST ON}
  {$WARN CASE_LABEL_RANGE ON}
  {$WARN FOR_VARIABLE ON}
  {$WARN CONSTRUCTING_ABSTRACT ON}
  {$WARN COMPARISON_FALSE ON}
  {$WARN COMPARISON_TRUE ON}
  {$WARN COMPARING_SIGNED_UNSIGNED ON}
  {$WARN COMBINING_SIGNED_UNSIGNED ON}
  {$WARN UNSUPPORTED_CONSTRUCT ON}
  {$WARN FILE_OPEN ON}
  {$WARN FILE_OPEN_UNITSRC ON}
  {$WARN BAD_GLOBAL_SYMBOL ON}
  {$WARN DUPLICATE_CTOR_DTOR ON}
  {$WARN INVALID_DIRECTIVE ON}
  {$WARN PACKAGE_NO_LINK ON}
  {$WARN PACKAGED_THREADVAR ON}
  {$WARN IMPLICIT_IMPORT ON}
  {$WARN HPPEMIT_IGNORED ON}
  {$WARN NO_RETVAL ON}
  {$WARN USE_BEFORE_DEF ON}
  {$WARN FOR_LOOP_VAR_UNDEF ON}
  {$WARN UNIT_NAME_MISMATCH ON}
  {$WARN NO_CFG_FILE_FOUND ON}
  {$WARN MESSAGE_DIRECTIVE ON}
  {$WARN IMPLICIT_VARIANTS ON}
  {$WARN UNICODE_TO_LOCALE ON}
  {$WARN LOCALE_TO_UNICODE ON}
  {$WARN IMAGEBASE_MULTIPLE ON}
  {$WARN SUSPICIOUS_TYPECAST ON}
  {$WARN PRIVATE_PROPACCESSOR ON}
  {$WARN UNSAFE_TYPE OFF}
  {$WARN UNSAFE_CODE OFF}
  {$WARN UNSAFE_CAST OFF}
{$ENDIF}
{$APPTYPE GUI}
{.$MODE DELPHI}
{ -- /Compiler options -- }


{$IFNDEF UNICODE}
  {$DEFINE UNICODE}
{$ENDIF}


{$IFDEF CLIPCONSOLE_DEBUG_MEMORY}
  uses
    FastMM4,
    ShareMem,
    ClipConsoleUnit in 'ClipConsoleUnit.pas' {ClipConsoleForm};

{$ELSE}

  uses
    Windows,
    SysUtils,
    Classes,
    Messages,
    Forms,
    ClipConsoleUnit in 'ClipConsoleUnit.pas' {ClipConsoleForm};

{$ENDIF}


{$E exe}
{$R *.res}

begin
  if ParamCount < 2 then Exit;

  {
  if (CreateMutex(nil, False, 'ClipConsoleMutex') <> 0)
   and (GetLastError = ERROR_ALREADY_EXISTS) then begin
    Exit;
  end;
  }

  Application.Initialize;
  Application.Title := 'ClipConsole';
  Application.CreateForm(TClipConsoleForm, ClipConsoleForm);
  Application.ShowMainForm := False;
  Application.Run;
end.

